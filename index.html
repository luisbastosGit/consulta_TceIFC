<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <?!= include('stylesheet.css'); ?>
</head>
<body>
  <nav class="navbar navbar-dark bg-dark">
    <a class="navbar-brand" href="#">Sistema de Gerenciamento de Estágios</a>
    <div class="navbar-text">
      <span>Olá, <?!= user.nome; ?> <small id="version-display" class="text-muted"></small></span>
      <a href="#" id="logout-link" class="ml-3 text-white">Sair</a>
    </div>
  </nav>

  <div class="container-fluid mt-4">
    <div class="card mb-4">
      <div class="card-body">
        <h5 class="card-title">Filtros de Busca</h5>
        <form id="search-form">
          <div class="form-row align-items-end">
            <div class="form-group col-md-3"><label for="filter-status">Status</label><select id="filter-status" class="form-control"><option value="">Todos</option></select></div>
            <div class="form-group col-md-3"><label for="filter-curso">Curso</label><select id="filter-curso" class="form-control"><option value="">Todos</option></select></div>
            <div class="form-group col-md-3"><label for="filter-orientador">Orientador</label><select id="filter-orientador" class="form-control"><option value="">Todos</option></select></div>
            <div class="form-group col-md-3"><label for="filter-nome">Nome do Aluno</label><input type="text" id="filter-nome" class="form-control" placeholder="Digite para buscar..."></div>
          </div>
          <div class="form-row align-items-end mt-3">
            <div class="form-group col-md-3"><label for="filter-turma">Turma/Fase</label><select id="filter-turma" class="form-control"><option value="">Todas</option></select></div>
            <div class="form-group col-md-9">
              <button type="submit" class="btn btn-primary">Buscar</button>
              <button type="button" id="clear-filters" class="btn btn-secondary ml-2">Limpar Filtros</button>
              <button type="button" id="print-button" class="btn btn-info ml-4">Imprimir</button>
              <button type="button" id="report-button" class="btn btn-success ml-2">
                <span id="report-spinner" class="spinner-border spinner-border-sm" role="status" aria-hidden="true" style="display: none;"></span>
                Gerar Relatório
              </button>
            </div>
          </div>
        </form>
      </div>
    </div>
    
    <h4>Resultados</h4>
    <div id="alert-container"></div>
    <div class="spinner-border text-primary" role="status" id="loading-spinner" style="display: none;"><span class="sr-only">Carregando...</span></div>
    <div id="results-table-container" class="table-responsive"></div>
    <p id="no-results-message" class="text-muted" style="display: none;">Nenhum resultado encontrado.</p>
  </div>

  <div class="modal fade" id="grades-modal" tabindex="-1" role="dialog"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="modal-title">Lançar Notas - </h5><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body"><form id="grades-form"><input type="hidden" id="modal-idRegistro"><div class="form-group"><label for="modal-nota-supervisor">Nota Supervisor</label><input type="number" class="form-control" id="modal-nota-supervisor" step="0.1"></div><div class="form-group"><label for="modal-nota-relatorio">Nota Relatório</label><input type="number" class="form-control" id="modal-nota-relatorio" step="0.1"></div><div class="form-group"><label for="modal-nota-defesa">Nota da Defesa</label><input type="number" class="form-control" id="modal-nota-defesa" step="0.1"></div><div class="form-group"><label for="modal-observacoes">Observações</label><textarea class="form-control" id="modal-observacoes" rows="3"></textarea></div></form></div><div class="modal-footer"><div id="saving-spinner" class="spinner-border spinner-border-sm text-primary" role="status"></div><button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button><button type="button" class="btn btn-primary" id="save-grades-button">Salvar</button></div></div></div></div>

  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

  <script>
    const loggedInUserName = "<?!= user.nome; ?>";
  </script>
  
  <?!= include('javascript.js'); ?>
  <link rel="stylesheet" href="style.css">
  <script src="javascript.js"></script>
</body>
</html>
